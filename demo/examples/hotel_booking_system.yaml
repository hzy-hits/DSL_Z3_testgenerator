# 酒店预订系统 DSL
# 基于需求文档设计的领域特定语言
domain: Hotel Booking System

entities:
  - name: Customer
    attributes:
      - name: age
        type: integer
        min: 18
        max: 120
        description: 客户年龄必须大于等于18岁
        
      - name: member_level
        type: integer
        min: 1
        max: 3
        enum_values: [1, 2, 3]
        description: 会员等级 - 1:普通, 2:银卡, 3:金卡
        
      - name: is_vip
        type: boolean
        description: 是否为VIP客户

  - name: Room
    attributes:
      - name: room_type
        type: integer
        min: 1
        max: 3
        enum_values: [1, 2, 3]
        description: 房间类型 - 1:标准间, 2:豪华间, 3:套房
        
      - name: base_price
        type: real
        min: 200.0
        max: 3000.0
        description: 房间基础价格

  - name: Booking
    attributes:
      - name: booking_days
        type: integer
        min: 1
        max: 30
        description: 预订天数，最长30天
        
      - name: guest_count
        type: integer
        min: 1
        max: 4
        description: 入住人数，最多4人
        
      - name: discount_percent
        type: integer
        min: 0
        max: 50
        description: 折扣百分比
        
      - name: is_peak_season
        type: boolean
        description: 是否为旺季
        
      - name: total_price
        type: real
        min: 0.0
        max: 100000.0
        description: 总价格

constraints:
  # 客户约束
  - customer_age >= 18
  - customer_member_level >= 1 and customer_member_level <= 3
  
  # 房间价格约束
  - room_room_type == 1 -> room_base_price >= 200.0 and room_base_price <= 500.0
  - room_room_type == 2 -> room_base_price >= 500.0 and room_base_price <= 1000.0
  - room_room_type == 3 -> room_base_price >= 1000.0 and room_base_price <= 3000.0
  
  # 预订约束
  - booking_booking_days >= 1 and booking_booking_days <= 30
  - booking_guest_count >= 1 and booking_guest_count <= 4
  - booking_discount_percent >= 0 and booking_discount_percent <= 50
  - booking_total_price >= 0.0

rules:
  - name: 银卡会员折扣
    condition: customer_member_level == 2
    implies: booking_discount_percent >= 10
    description: 银卡会员至少享受10%折扣
    
  - name: 金卡会员折扣
    condition: customer_member_level == 3
    implies: booking_discount_percent >= 20
    description: 金卡会员至少享受20%折扣
    
  - name: VIP客户特权
    condition: customer_is_vip == true
    implies: booking_discount_percent >= 15
    description: VIP客户至少享受15%折扣
    
  - name: 旺季折扣限制
    condition: booking_is_peak_season == true
    implies: booking_discount_percent <= 10
    description: 旺季最多10%折扣
    
  - name: 长期住宿优惠
    condition: booking_booking_days >= 7
    implies: booking_discount_percent >= 5
    description: 住宿7天以上至少5%折扣
    
  - name: 套房最少住宿天数
    condition: room_room_type == 3
    implies: booking_booking_days >= 2
    description: 套房至少预订2天

test_requirements:
  - name: 客户年龄边界测试
    type: boundary
    focus: [age]
    
  - name: 会员等级测试
    type: equivalence
    focus: [member_level]
    
  - name: 房间类型测试
    type: equivalence
    focus: [room_type]
    
  - name: 预订天数边界测试
    type: boundary
    focus: [booking_days]
    
  - name: 折扣边界测试
    type: boundary
    focus: [discount_percent]
    
  - name: 负面测试
    type: negative
    focus: [constraints]